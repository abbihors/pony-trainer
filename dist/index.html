<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Pony Trainer</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class='wrapper'>
        <div class='readme'>
            <h1>Pony Trainer</h1>

            <h2>What is this?</h2>
            <p>This is a web app designed to train ponies using classical conditioning. It does this by allowing you
                to control your Bluetooth vibrator using your voice. If you make the correct noises (e.g. a neigh or
                snort), you will be rewarded!</p>

            <h2>Will this app record me?</h2>
            <p>
                No. The app only keeps the last second of audio at any
                given time, and it is never uploaded anywhere. If you'd
                like, you could can open this page in private mode and
                turn off your internet after loading this page, and the
                app will continue to work.
            </p>

            <h2>Toy compatibility</h2>
            <p>This app will work with any of the (roughly) 150 toys
                that are supported by the <a href='https://buttplug.io/'>Buttplug</a> library. If you'd
                like to see if your app is supported, you can check <a
                    href='https://iostindex.com/?filtersChanged=1&filter0ButtplugSupport=4'>here</a>.</p>

            <h2>Browser compatibility</h2>
            <p>
                Currently only Chrome and Chromium-based browsers like
                Edge are supported, however Firefox and Safari support
                will be added later but you will have to run <a href=https://intiface.com/desktop/">Intiface
                    Desktop</a>
                on your desktop, as neither of these browsers can
                interact with Bluetooth devices directly.
            </p>
        </div>

        <div class='app'>
            <div class='wrapper-button'>
                <button id='btn-listen'>Start listening</button>
            </div>

            <div class='wrapper-listen'>
                <h3>Start listening</h3>
                <p>Speak into the microphone and use the slider to adjust the voice activation threshold. Try to get it so that it only turns green when you speak.</p>

                <input type="range" id="threshold" min="0" max="0.2" value="0.04" step="0.01">

                <div class='voicemeter-wrapper'>
                    <div class='voicemeter-recordvol'></div>
                    <div class='voicemeter'></div>
                </div>
            </div>

            <div class='wrapper-button'>
                <button id='btn-connect'>Connect a vibrator</button>
            </div>
            
            <div class='wrapper-results'>
                <p>▸ Lovense Hush v223</p>
                <button id='btn-test'>Test vibration</button>
            </div>

            <div class='bars'>
                <div class='progressbar-wrapper'>
                    <div class='progressbar'></div>
                </div>
            </div>
        </div>

        <div class='footer'>
            <p>Copyright © 2021 — Source code available on <a>GitHub</a></p>
        </div>
    </div>

    <script>
        let bar = document.querySelector('.voicemeter');

        setInterval(() => {
            bar.style.width = (Math.random() * (100 - 0) + 0) + '%';
        }, 1500);
    </script>

    <script lang="javascript" src="https://cdn.jsdelivr.net/npm/buttplug@1.0.14/dist/web/buttplug.min.js"></script>
    <script src='main.js'></script>
</body>

</html>